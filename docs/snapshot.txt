BOARD=Waveshare ESP32-S3 Touch AMOLED 2.41; MCU=ESP32-S3; FLASH=16MB; PSRAM=8MB; DISPLAY_CTRL=RM690B0; DISPLAY_IF=QSPI 32-bit cmd; DISPLAY_RES=600x450; TOUCH_CTRL=FT6336U I2C 0x38; CIRCUITPY_VERSION=10.0.3;
PINS_DISPLAY_QSPI_CS=GPIO9; PINS_DISPLAY_QSPI_SCK=GPIO10; PINS_DISPLAY_QSPI_D0=GPIO11; PINS_DISPLAY_QSPI_D1=GPIO12; PINS_DISPLAY_QSPI_D2=GPIO13; PINS_DISPLAY_QSPI_D3=GPIO14; PINS_DISPLAY_RESET=GPIO21; PINS_DISPLAY_POWER=GPIO16; PINS_DISPLAY_WIDTH=600; PINS_DISPLAY_HEIGHT=450; PINS_PIXEL_CLOCK_HZ=80MHz;
PINS_I2C_SDA=GPIO47; PINS_I2C_SCL=GPIO48; PINS_TOUCH_RESET=GPIO3; PINS_TOUCH_INT=EXIO2; PINS_SD_SPI_CS=GPIO2; PINS_SD_SPI_SCK=GPIO4; PINS_SD_SPI_MOSI=GPIO5; PINS_SD_SPI_MISO=GPIO6;
I2C_DEVICES=FT6336U:0x38,RTC:0x51,IMU:0x6B,IO_EXP:0x20;
RM690B0_STATUS=Production-ready standalone rendering (graphics primitives, images, native text); RM690B0_LVGL_STATUS=Feature-complete widgets+touch (except Calendar/Bitmap), NOT production-ready (GC/touch bug); NEXT_MILESTONE=Phase 6 – docs+stability+widget expansion;
RM690B0_FEATURES=DMA-backed framebuffer in PSRAM; 30-line DMA limit; even-pixel alignment with internal padding; RGB565 GB swap; adaptive_delay_us=pixels/36,min50; single-pixel-accurate primitives; BMP+JPEG image support (JPEG via esp_jpeg); double-buffering with swap_buffers(); brightness API via WRDISBV/WRCTRLD; rotations via software remap; PSRAM framebuffer + DMA staging; native text rendering with built-in bitmap fonts;
RM690B0_PERF=~25ms full-screen fill; ~14ms 10-circle burst; circles 39× faster vs naive; 100+FPS rendering possible with current flush;
RM690B0_TEXT_API=set_font(font_id), text(x,y,text,color,background); 7 built-in fonts: 8x8, 16x16, 16x24, 24x24, 24x32, 32x32, 32x48; row-based bitmap format MSB-first; ASCII 0x20-0x7E (95 chars); transparent or solid background; independent from LVGL;
RM690B0_FONTS=Font IDs: 0=8x8 (760B), 1=16x16 (30KB Liberation Sans), 2=16x24 (45KB Liberation Mono Bold), 3=24x24 (68KB), 4=24x32 (91KB), 5=32x32 (121KB), 6=32x48 (182KB); Total ~538KB in flash; Converter: ttf_to_rm690b0.py (any TTF→bitmap); Format: row-based, MSB=leftmost pixel, 1=fg/0=bg;
STORAGE=Flash for code/assets; PSRAM for framebuffer/LVGL; SD via espsdcard (reliable, ~645KB/s, chunked reads, retry throttling);
LVGL_VERSION=8.x; LVGL_BUFFERS=2×(600×30 rows) in PSRAM; LVGL_DMA_BUFFERS=2×(600+padding)*(30+padding) in SRAM MALLOC_CAP_DMA; LVGL_TICK=2ms esp_timer; LV_USE_TINY_TTF=1; LV_TINY_TTF_FILE_SUPPORT=1; TINY_TTF_CACHE=16KB via lv_tiny_ttf_create_data_ex;
LVGL_DISPLAY_DRIVER=flush_cb using RM690B0 DMA, padding+color_swap; LVGL_TOUCH_DRIVER=FT6336U, portrait(450×600)→landscape(600×450) transform x=599-touch_y,y=touch_x; early-return in touch if image_subsystem_initialized=false; auto init_rendering() from init_display() to avoid race;
PY_API_RM690B0=init_display(), fill*, line, circle, rect, swap_buffers(), brightness prop, rotation/size getters, set_font(id), text(x,y,str,color,bg);
PY_API_RM690B0_LVGL=RM690B0_LVGL(), init_display(), init_rendering(), init_touch(i2c), task_handler(), test_draw();
WIDGET_BASE=Widget(native_obj, x,y,width,height, set_style_bg_color(), set_style_bg_opa(), set_style_text_color(), set_style_text_font(), set_parent(), delete()); WIDGET_CLASSES=Widget, Label(text,x,y,color,font), Button(text,on_click), plus many LVGL widgets in C (Bar, Slider, Switch, Roller, Spinbox, Msgbox, Tabview, Table, Buttonmatrix, Textarea, Keyboard, Chart, Canvas, Line, Container, Checkbox, Dropdown, List, Spinner, Scale; TODO: Calendar, Bitmap bindings);
FONT_API_LVGL=rm690b0_lvgl.Font(file_or_data,size); Font.from TTF via Tiny TTF; methods=set_size(), deinit(); font.source keeps buffer; native_font via lv_tiny_ttf_create_data_ex(data,len,size,16384);
FONT_API_NATIVE=rm690b0.set_font(font_id) where font_id: 0=8x8, 1=16x16, 2=16x24, 3=24x24, 4=24x32, 5=32x32, 6=32x48; rm690b0.text(x,y,text,color,background) draws UTF-8 text; transparent bg if background=None; independent from LVGL/TTF; 7 fonts totaling ~538KB flash;
FONT_TOOLS=ttf_to_rm690b0.py converts any TTF to bitmap header; test_converted_font.py validates/previews fonts; example_ttf_conversion.sh demonstrates 7 conversion scenarios; docs: TTF_CONVERTER_README.md, QUICK_START_TTF.md, TTF_CONVERTER_SUMMARY.md;
GC_TOUCH_BUG_DESC=LVGL+touch can freeze (no touch response) after repeated gc.collect() or heavy heap allocations (e.g. TTF) despite I2C ref rooting; GC_TOUCH_BUG_SCOPE=ESP32-S3 rm690b0_lvgl port; GC_TOUCH_WORKAROUND=avoid gc.collect() in UI loop; load TTF early; treat LVGL as beta for long-running interactive apps;
KNOWN_ISSUES_LIST=1:GC/touch freeze; 2:LVGL stability under heavy allocation; others: DMA alignment, SD timing handled;
DOC_FILES=README.md (index); TECHNICAL_NOTES.md (RM690B0, touch, storage, perf, issues); RM690B0_LVGL.md (LVGL integration, Python API, examples); project_status_summary.md (readiness+risks incl. GC/touch bug); project_summary.yaml (machine-readable config+status);
KEY_CODE_FILES=ports/espressif/common-hal/rm690b0/RM690B0.c; ports/espressif/common-hal/rm690b0/esp_lcd_rm690b0.c; ports/espressif/common-hal/rm690b0_lvgl/RM690B0_LVGL.c; ports/espressif/common-hal/rm690b0_lvgl/Widget.c+all widget .c; ports/espressif/common-hal/rm690b0_lvgl/Font.c; shared-bindings/rm690b0/*.c; shared-bindings/rm690b0_lvgl/*.c; ports/espressif/common-hal/rm690b0/fonts/*.h (7 font headers);
FONT_FILES=rm690b0_font_8x8.h, rm690b0_font_16x16.h, rm690b0_font_16x24.h, rm690b0_font_24x24.h, rm690b0_font_24x32.h, rm690b0_font_32x32.h, rm690b0_font_32x48.h; FONT_CONVERTER=fonts/ttf_to_rm690b0.py (457 lines); FONT_VALIDATOR=fonts/test_converted_font.py (377 lines);
TEST_SCRIPTS=tests in test_scripts/: test_gui.py (full GUI, TTF, touch), test_ttf_simple.py (TTF+touch sanity), test_ttf_minimal.py (minimal TTF+touch loop), quick_test/adaptive_delay tests (w RM690B0 context);
RULES_PRACTICAL=init rm690b0 before rm690b0_lvgl.init_display(); init_touch(i2c) po init_display/init_rendering; nie używać gc.collect() w każdej iteracji pętli LVGL; TTF ładować raz na starcie; używać task_handler() co 10–20ms; SD używać przez espsdcard; nie przekraczać 30 linii na DMA transfer; nie ruszać MADCTL poza driverem; use native text API for labels/debug (lightweight, no TTF overhead);
STATUS_SUMMARY=rm690b0 driver: stable+fast with native text; rm690b0_lvgl: functional (widgets, touch, TTF) but with critical bug GC/touch; projekt w fazie 5 zakończonej funkcjonalnie, faza 6: dokumentacja+stabilność+rozszerzenie widgetów; native text rendering complete with 7 built-in fonts and TTF converter toolchain.
